(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-240ebb33"],{"10d2":function(e,t,s){"use strict";s.r(t);s("ac1f"),s("841c");var r=function(){var e=this,t=e._self._c;return t("div",[t("reloadAndsearch",{ref:"search",attrs:{config:e.searchConfig},on:{search:e.search}}),t("div",{staticClass:"list-model"},[t("TableList",{attrs:{pageMethod:e.getTableData,searchMethod:e.getTableData,"table-data":e.tableData,tableColumn:e.tableColumn,query:e.query,total:e.total,loading:e.loadings.table,multiCheck:e.multiCheck},on:{"update:query":function(t){e.query=t}},scopedSlots:e._u([{key:"column-supplier",fn:function(s){return[t("div",[e._v(e._s(s.row.supplierCode)+e._s(s.row.supplierName))])]}},{key:"column-todo",fn:function(s){return[t("el-button",{staticClass:"prohibitclick",attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(s.row)}}},[e._v("编辑")]),t("el-button",{staticClass:"prohibitclick",attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteRow(s.row)}}},[e._v("删除")])]}}])}),e.drawer?t("addressEdit",{attrs:{drawer:e.drawer,rowData:e.rowData},on:{close:function(t){e.drawer=!1},success:function(t){return e._success()}}}):e._e()],1)],1)},a=[],i=s("5530"),l=(s("d3b7"),s("159b"),s("14d9"),s("ffd4")),o=s("c367"),d=s("7e1e"),n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.ifCreate?"新增供应商地址":"编辑供应商地址",visible:e.drawer,direction:e.direction,"close-on-press-escape":!1,"show-close":!1,wrapperClosable:!1,"append-to-body":!0,width:"780px"},on:{"update:visible":function(t){e.drawer=t}}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"供应商",prop:"supplierAddressKey"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择供应商",clearable:"",filterable:"",remote:"","remote-method":e.remoteMethod},model:{value:e.ruleForm.supplierAddressKey,callback:function(t){e.$set(e.ruleForm,"supplierAddressKey",t)},expression:"ruleForm.supplierAddressKey"}},e._l(e.supplierList,(function(s,r){return t("el-option",{key:s.supplierKey+r,attrs:{label:s.supplierName,value:s.supplierKey}},[t("div",[e._v("["+e._s(s.supplierCode)+"]"+e._s(s.supplierName))])])})),1)],1),t("el-form-item",{attrs:{label:"地址类型",prop:"addressType"}},[t("el-input",{attrs:{placeholder:"地址类型",clearable:""},model:{value:e.ruleForm.addressType,callback:function(t){e.$set(e.ruleForm,"addressType",t)},expression:"ruleForm.addressType"}})],1),t("el-form-item",{attrs:{label:"联系地址",prop:"address"},model:{value:e.ruleForm.address,callback:function(t){e.$set(e.ruleForm,"address",t)},expression:"ruleForm.address"}},[t("checkAddress",{ref:"address",attrs:{form:e.ruleForm.address},model:{value:e.ruleForm.address,callback:function(t){e.$set(e.ruleForm,"address",t)},expression:"ruleForm.address"}})],1),t("el-row",{staticClass:"dialog_footer"},[0==e.ifCreate?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save("ruleForm")}}},[e._v("提交")]):t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.create("ruleForm")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(t){return e.close()}}},[e._v("关闭")])],1)],1)],1)},u=[],c=(s("d9e2"),s("1871")),p={components:{checkAddress:c["a"]},data:function(){var e=this,t=function(t,s,r){""!=e.ruleForm.address.province&&""!=e.ruleForm.address.detail||r(new Error("请输入完整地址")),r()};return{supplierList:[],direction:"btt",ifCreate:!1,ruleForm:{addressKey:"",addressType:"",supplierAddressKey:"",address:{province:"",city:"",district:"",detail:""}},rules:{supplierAddressKey:[{required:!0,message:"请选择供应商",trigger:"blur"}],addressType:[{required:!0,message:"请输入地址类型",trigger:"blur"}],address:[{required:!0,validator:t,trigger:"blur"}]}}},props:{drawer:{default:!0},rowData:{},multiple:{type:Boolean,default:!1}},methods:{close:function(){this.$parent.drawer=!1},create:function(e){var t=this,s={province:this.ruleForm.address.province,city:this.ruleForm.address.city,district:this.ruleForm.address.district,detail:this.ruleForm.address.detail,addressType:this.ruleForm.addressType,supplierAddressKey:this.ruleForm.supplierAddressKey};this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(d["qb"])(s).then((function(e){200===e.data.code?(t.$parent.success(),t.$forceUpdate(),t.$message.success("新增成功!"),t._handleFresh()):t.$message.error(e.msg)})).catch((function(e){console.log(e)}))}))},save:function(e){var t=this,s={addressKey:this.ruleForm.addressKey,province:this.ruleForm.address.province,city:this.ruleForm.address.city,district:this.ruleForm.address.district,detail:this.ruleForm.address.detail,addressType:this.ruleForm.addressType,supplierAddressKey:this.ruleForm.supplierAddressKey};this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(d["tb"])(s).then((function(e){200===e.data.code?(t.$parent.success(),t.$forceUpdate(),t.$message.success("修改成功!"),t._handleFresh()):t.$message.error(e.msg)})).catch((function(e){console.log(e)}))}))},getSupplierlist:function(){var e=this;Object(d["o"])().then((function(t){200==t.data.code?e.supplierList=t.data.data:e.$message.error("获取失败!")}))},remoteMethod:function(e){this.getSupplierList(e)}},watch:{},created:function(){this.getSupplierlist(),this.rowData.addressKey?(this.ruleForm.addressKey=this.rowData.addressKey,this.ruleForm.address.province=this.rowData.province,this.ruleForm.address.city=this.rowData.city,this.ruleForm.address.district=this.rowData.district,this.ruleForm.address.detail=this.rowData.detail,this.ruleForm.addressType=this.rowData.addressType,this.ruleForm.supplierAddressKey=this.rowData.supplierAddressKey):this.ifCreate=!0,this.$route.params.supplierKey&&(this.ruleForm.supplierAddressKey=this.$route.params.supplierKey)}},h=p,m=(s("cf22"),s("2877")),f=Object(m["a"])(h,n,u,!1,null,"646c469e",null),y=f.exports,b={components:{reloadAndsearch:l["a"],TableList:o["a"],addressEdit:y},data:function(){return{supplyDetail:{},loadings:{table:!0},query:{pageNo:1,pageSize:10},rowData:{},drawer:!1,multiCheck:!0,multipleSelection:[],total:null,tableData:[],supplierList:[]}},methods:{getSupplierlist:function(){var e=this;Object(d["o"])().then((function(t){200==t.data.code?(e.supplierList=[],t.data.data.forEach((function(t){e.supplierList.push({label:t.supplierName,value:t.supplierKey})}))):e.$message.error("获取失败!")}))},getTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1?arguments[1]:void 0;this.query.pageNo=t,s&&(this.query.pageSize=s),this.loadings.table=!0;var r=this.$refs.search.search,a=Object(i["a"])(Object(i["a"])({},r),{},{page:this.query.pageNo,size:this.query.pageSize});this.supplyDetail.supplierKey&&(a.supplierAddressKey=this.supplyDetail.supplierKey),Object(d["sb"])(a).then((function(t){e.tableData=t.data.data.records,e.total=t.data.data.total})).finally((function(){e.loadings.table=!1}))},search:function(e,t){var s=this;this.query.pageNo=e,t&&(this.query.pageSize=t),this.loadings.table=!0;var r=this.$refs.search.search,a={supplierAddressKey:r.supplierAddressKey||this.$route.params.supplierKey||"",page:this.query.pageNo,size:this.query.pageSize};Object(d["sb"])(a).then((function(e){s.tableData=e.data.data.records,s.total=e.data.data.total,console.log("skuList:",s.tableData)})).finally((function(){s.loadings.table=!1}))},add:function(){this.editRow({})},editRow:function(e){this.rowData=e,this.drawer=!0},deleteRow:function(e){var t=this;this.$confirm("删除操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["rb"])({supplierAddressKeys:e.supplierAddressKey}).then((function(e){200==e.data.code?(t.$message.success("删除成功!"),t.search(),t.$forceUpdate()):t.$message.error(e.data.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSelectionDelete:function(e){this.multipleSelection=e},handleDeleteList:function(){var e=this;if(this.multipleSelection.length>0){var t=[];this.multipleSelection.forEach((function(e){t.push({addressKey:e.addressKey})})),console.log(t),this.$confirm("删除操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["s"])(t).then((function(){e.getTableData(),e.$message({type:"success",message:"删除成功!"}),e._handleFresh()})).catch((function(e){console.log(e)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"}),e.multipleSelection=[]}))}else this.$message({type:"error",message:"至少选择一项"})},success:function(){this.drawer=!1,this.rowData={},this.search()}},computed:{tableColumn:function(){return[{slots:{name:"column-supplier"},label:"所属供应商"},{prop:"addressType",label:"地址类型",width:180},{prop:"province",label:"省",width:"100px",sortable:!0},{prop:"city",label:"市",width:"100px"},{prop:"district",label:"区",width:"100px"},{prop:"detail",label:"详细地址"},{slots:{name:"column-todo"},label:"操作",fixed:"right",width:"120px"}]},searchConfig:function(){return[{label:"请选择",placeholder:"请选择供应商",field:"supplierAddressKey",value:"",type:"select",options:this.supplierList}]}},created:function(){if(this.$route.params.supplierKey){var e=localStorage.getItem("supplyDetail");e&&(this.supplyDetail=JSON.parse(e))}this.getSupplierlist()}},g=b,w=Object(m["a"])(g,r,a,!1,null,null,null);t["default"]=w.exports},"8f7c":function(e,t,s){},cf22:function(e,t,s){"use strict";s("8f7c")}}]);
//# sourceMappingURL=chunk-240ebb33.b41be5ab.js.map