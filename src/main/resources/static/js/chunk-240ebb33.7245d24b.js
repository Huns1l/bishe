(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-240ebb33"],{"10d2":function(e,r,t){"use strict";t.r(r);t("ac1f"),t("841c");var s=function(){var e=this,r=e._self._c;return r("div",[r("reloadAndsearch",{ref:"search",attrs:{config:e.searchConfig},on:{search:e.search}}),r("div",{staticClass:"list-model"},[r("TableList",{attrs:{pageMethod:e.getTableData,searchMethod:e.getTableData,"table-data":e.tableData,tableColumn:e.tableColumn,query:e.query,total:e.total,loading:e.loadings.table,multiCheck:e.multiCheck},on:{"update:query":function(r){e.query=r}},scopedSlots:e._u([{key:"column-supplier",fn:function(t){return[r("div",[e._v(e._s(t.row.supplierCode)+e._s(t.row.supplierName))])]}},{key:"column-todo",fn:function(t){return[r("el-button",{staticClass:"prohibitclick",attrs:{type:"text",size:"small"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")]),r("el-button",{staticClass:"prohibitclick",attrs:{type:"text",size:"small"},on:{click:function(r){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])}),e.drawer?r("addressEdit",{attrs:{drawer:e.drawer,rowData:e.rowData},on:{close:function(r){e.drawer=!1},success:function(r){return e._success()}}}):e._e()],1)],1)},a=[],i=t("5530"),l=(t("d3b7"),t("159b"),t("14d9"),t("ffd4")),o=t("c367"),d=t("7e1e"),u=function(){var e=this,r=e._self._c;return r("el-dialog",{attrs:{title:e.ifCreate?"新增供应商地址":"编辑供应商地址",visible:e.drawer,direction:e.direction,"close-on-press-escape":!1,"show-close":!1,wrapperClosable:!1,"append-to-body":!0,width:"780px"},on:{"update:visible":function(r){e.drawer=r}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"供应商",prop:"supplierAddressKey"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择供应商",clearable:"",filterable:"",remote:"","remote-method":e.remoteMethod},model:{value:e.ruleForm.supplierAddressKey,callback:function(r){e.$set(e.ruleForm,"supplierAddressKey",r)},expression:"ruleForm.supplierAddressKey"}},e._l(e.supplierList,(function(t,s){return r("el-option",{key:t.supplierKey+s,attrs:{label:t.supplierName,value:t.supplierKey}},[r("div",[e._v("["+e._s(t.supplierCode)+"]"+e._s(t.supplierName))])])})),1)],1),r("el-form-item",{attrs:{label:"地址类型",prop:"addressType"}},[r("el-input",{attrs:{placeholder:"地址类型",clearable:""},model:{value:e.ruleForm.addressType,callback:function(r){e.$set(e.ruleForm,"addressType",r)},expression:"ruleForm.addressType"}})],1),r("el-form-item",{attrs:{label:"联系地址",prop:"address"},model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}},[r("checkAddress",{ref:"address",attrs:{form:e.ruleForm.address},model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}})],1),r("el-row",{staticClass:"dialog_footer"},[0==e.ifCreate?r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.save("ruleForm")}}},[e._v("提交")]):r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.create("ruleForm")}}},[e._v("立即创建")]),r("el-button",{on:{click:function(r){return e.close()}}},[e._v("关闭")])],1)],1)],1)},c=[],n=(t("d9e2"),t("1871")),p={components:{checkAddress:n["a"]},data:function(){var e=this,r=function(r,t,s){""!=e.ruleForm.address.province&&""!=e.ruleForm.address.detail||s(new Error("请输入完整地址")),s()};return{supplierList:[],direction:"btt",ifCreate:!1,ruleForm:{addressKey:"",addressType:"",supplierAddressKey:"",address:{province:"",city:"",district:"",detail:""}},rules:{supplierAddressKey:[{required:!0,message:"请选择供应商",trigger:"blur"}],addressType:[{required:!0,message:"请输入地址类型",trigger:"blur"}],address:[{required:!0,validator:r,trigger:"blur"}]}}},props:{drawer:{default:!0},rowData:{},multiple:{type:Boolean,default:!1}},methods:{close:function(){this.$parent.drawer=!1},create:function(e){var r=this,t={province:this.ruleForm.address.province,city:this.ruleForm.address.city,district:this.ruleForm.address.district,detail:this.ruleForm.address.detail,addressType:this.ruleForm.addressType,supplierAddressKey:this.ruleForm.supplierAddressKey};this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(d["pb"])(t).then((function(e){200===e.data.code?(r.$parent.success(),r.$forceUpdate(),r.$message.success("新增成功!"),r._handleFresh()):r.$message.error(e.msg)})).catch((function(e){console.log(e)}))}))},save:function(e){var r=this,t={addressKey:this.ruleForm.addressKey,province:this.ruleForm.address.province,city:this.ruleForm.address.city,district:this.ruleForm.address.district,detail:this.ruleForm.address.detail,addressType:this.ruleForm.addressType,supplierAddressKey:this.ruleForm.supplierAddressKey};this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(d["sb"])(t).then((function(e){200===e.data.code?(r.$parent.success(),r.$forceUpdate(),r.$message.success("修改成功!"),r._handleFresh()):r.$message.error(e.msg)})).catch((function(e){console.log(e)}))}))},getSupplierlist:function(){var e=this;Object(d["o"])().then((function(r){200==r.data.code?e.supplierList=r.data.data:e.$message.error("获取失败!")}))},remoteMethod:function(e){this.getSupplierList(e)}},watch:{},created:function(){this.getSupplierlist(),this.rowData.addressKey?(this.ruleForm.addressKey=this.rowData.addressKey,this.ruleForm.address.province=this.rowData.province,this.ruleForm.address.city=this.rowData.city,this.ruleForm.address.district=this.rowData.district,this.ruleForm.address.detail=this.rowData.detail,this.ruleForm.addressType=this.rowData.addressType,this.ruleForm.supplierAddressKey=this.rowData.supplierAddressKey):this.ifCreate=!0,this.$route.params.supplierKey&&(this.ruleForm.supplierAddressKey=this.$route.params.supplierKey)}},h=p,m=(t("cf22"),t("2877")),f=Object(m["a"])(h,u,c,!1,null,"646c469e",null),y=f.exports,b={components:{reloadAndsearch:l["a"],TableList:o["a"],addressEdit:y},data:function(){return{supplyDetail:{},loadings:{table:!0},query:{pageNo:1,pageSize:10},rowData:{},drawer:!1,multiCheck:!0,total:null,tableData:[],supplierList:[]}},methods:{getSupplierlist:function(){var e=this;Object(d["o"])().then((function(r){200==r.data.code?(e.supplierList=[],r.data.data.forEach((function(r){e.supplierList.push({label:r.supplierName,value:r.supplierKey})}))):e.$message.error("获取失败!")}))},getTableData:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;this.query.pageNo=r,t&&(this.query.pageSize=t),this.loadings.table=!0;var s=this.$refs.search.search,a=Object(i["a"])(Object(i["a"])({},s),{},{page:this.query.pageNo,size:this.query.pageSize});this.supplyDetail.supplierKey&&(a.supplierAddressKey=this.supplyDetail.supplierKey),Object(d["rb"])(a).then((function(r){e.tableData=r.data.data.records,e.total=r.data.data.total})).finally((function(){e.loadings.table=!1}))},search:function(e,r){var t=this;this.query.pageNo=e,r&&(this.query.pageSize=r),this.loadings.table=!0;var s=this.$refs.search.search,a={supplierAddressKey:s.supplierAddressKey||this.$route.params.supplierKey||"",page:this.query.pageNo,size:this.query.pageSize};Object(d["rb"])(a).then((function(e){t.tableData=e.data.data.records,t.total=e.data.data.total,console.log("skuList:",t.tableData)})).finally((function(){t.loadings.table=!1}))},add:function(){this.editRow({})},editRow:function(e){this.rowData=e,this.drawer=!0},deleteRow:function(e){var r=this;console.log("deleteRow",e),Object(d["qb"])({supplierAddressKeys:e.supplierAddressKey}).then((function(e){200==e.data.code?(r.$message.success("删除成功!"),r.search(),r.$forceUpdate()):r.$message.error(e.data.msg)}))},success:function(){this.drawer=!1,this.rowData={},this.search()}},computed:{tableColumn:function(){return[{slots:{name:"column-supplier"},label:"所属供应商"},{prop:"addressType",label:"地址类型",width:180},{prop:"province",label:"省",width:"100px"},{prop:"city",label:"市",width:"100px"},{prop:"district",label:"区",width:"100px"},{prop:"detail",label:"详细地址"},{slots:{name:"column-todo"},label:"操作",fixed:"right",width:"120px"}]},searchConfig:function(){return[{label:"请选择",placeholder:"请选择供应商",field:"supplierAddressKey",value:"",type:"select",options:this.supplierList}]}},created:function(){if(this.$route.params.supplierKey){var e=localStorage.getItem("supplyDetail");e&&(this.supplyDetail=JSON.parse(e))}this.getSupplierlist()}},g=b,w=Object(m["a"])(g,s,a,!1,null,null,null);r["default"]=w.exports},"8f7c":function(e,r,t){},cf22:function(e,r,t){"use strict";t("8f7c")}}]);
//# sourceMappingURL=chunk-240ebb33.7245d24b.js.map